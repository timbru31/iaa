<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
  "http://struts.apache.org/dtds/struts-2.5.dtd">
<struts>
  <constant name="struts.action.excludePattern" value="/api/.*, /static/.*" />
  <constant name="struts.action.extension" value="" />

  <!-- catch 404 errors -->
  <package name="serveAll" namespace="" extends="struts-default">
    <result-types>
      <result-type name="tiles"
        class="org.apache.struts2.views.tiles.TilesResult" />
    </result-types>
    <action name="*">
      <result type="tiles">notFoundError</result>
    </action>
  </package>

  <package name="default" namespace="/" extends="tiles-default">
    <result-types>
      <result-type name="tiles"
        class="org.apache.struts2.views.tiles.TilesResult" />
    </result-types>

    <interceptors>
      <interceptor name="login"
        class="de.nordakademie.iaa_multiple_choice.web.interceptor.LoginInterceptor" />
      <interceptor name="lecturer"
        class="de.nordakademie.iaa_multiple_choice.web.interceptor.LecturerInterceptor" />
      <interceptor name="student"
        class="de.nordakademie.iaa_multiple_choice.web.interceptor.StudentInterceptor" />
      <interceptor-stack name="iaa-multiple-choice">
        <interceptor-ref name="login" />
        <interceptor-ref name="lecturer" />
        <interceptor-ref name="student" />
        <interceptor-ref name="defaultStack" />
      </interceptor-stack>
    </interceptors>

    <default-interceptor-ref name="iaa-multiple-choice" />
    <global-results>
      <result name="loginRedirect" type="tiles">login</result>
      <result name="genericError" type="tiles">genericError</result>
      <result name="forbidden" type="tiles">forbiddenError</result>
    </global-results>

    <global-exception-mappings>
      <exception-mapping exception="java.lang.Exception"
        result="genericError" />
    </global-exception-mappings>

    <action name=""
      class="de.nordakademie.iaa_multiple_choice.web.HomeAction">
      <result name="welcome" type="tiles">home</result>
      <result name="lecturer" type="redirectAction">
        <param name="actionName">lecturer</param>
      </result>
      <result name="student" type="redirectAction">
        <param name="actionName">student</param>
      </result>
    </action>

    <action name="home"
      class="de.nordakademie.iaa_multiple_choice.web.HomeAction">
      <result name="welcome" type="tiles">home</result>
      <result name="lecturer" type="redirectAction">
        <param name="actionName">lecturer</param>
      </result>
      <result name="student" type="redirectAction">
        <param name="actionName">student</param>
      </result>
    </action>

    <action name="lecturer"
      class="de.nordakademie.iaa_multiple_choice.web.LecturerAction">
      <result type="tiles">lecturer</result>
    </action>

    <action name="student"
      class="de.nordakademie.iaa_multiple_choice.web.StudentAction">
      <result type="tiles">student</result>
    </action>

    <action name="createExam"
      class="de.nordakademie.iaa_multiple_choice.web.ExamAction">
      <result type="tiles">exam/create</result>
    </action>

    <action name="saveExam"
      class="de.nordakademie.iaa_multiple_choice.web.ExamAction" method="saveExam">
      <result name="success" type="redirectAction">
        <param name="actionName">createQuestion</param>
        <param name="examId">${exam.id}</param>
      </result>
    </action>

    <action name="createQuestion"
      class="de.nordakademie.iaa_multiple_choice.web.QuestionAction">
      <result name="success" type="tiles">exam/create/question</result>
    </action>

    <action name="saveQuestion"
      class="de.nordakademie.iaa_multiple_choice.web.QuestionAction"
      method="saveQuestion">
      <result name="success" type="redirectAction">
        <param name="examId">${examId}</param>
        <param name="actionName">createQuestion</param>
      </result>
    </action>

    <action name="showExam">
      <result type="tiles">exam/show</result>
    </action>

    <action name="mapping">
      <result type="tiles">lecturer/mapping</result>
    </action>

    <action name="registration">
      <result name="input" type="tiles">registration</result>
      <result name="success" type="tiles">registration</result>
      <result name="successLecturer" type="tiles">lecturer</result>
      <result name="successStudent" type="tiles">student</result>
    </action>

    <action name="registerLecturer"
      class="de.nordakademie.iaa_multiple_choice.web.RegisterAction"
      method="registerLecturer">
      <result name="success" type="tiles">lecturer</result>
      <result name="input" type="tiles">registration</result>
    </action>

    <action name="registerStudent"
      class="de.nordakademie.iaa_multiple_choice.web.RegisterAction"
      method="registerStudent">
      <result name="success" type="tiles">student</result>
      <result name="input" type="tiles">registration</result>
    </action>

    <action name="login">
      <result type="tiles">login</result>
    </action>

    <action name="logout"
      class="de.nordakademie.iaa_multiple_choice.web.LogoutAction"
      method="logout">
      <result type="tiles">home</result>
    </action>

    <action name="loginUser"
      class="de.nordakademie.iaa_multiple_choice.web.LoginAction"
      method="login">
      <result name="successLecturer" type="tiles">lecturer</result>
      <result name="successStudent" type="tiles">student</result>
      <result name="input" type="tiles">login</result>
    </action>

    <action name="locale"
      class="de.nordakademie.iaa_multiple_choice.web.ChangeLanguageAction"
      method="changeLanguage">
      <result name="success" type="tiles">home</result>
    </action>
  </package>
</struts>
